aws eks describe-nodegroup --region us-east-1 --cluster-name mlops-cluster --nodegroup-name node


kubectl config get-clusters

aws eks update-kubeconfig --region <region-name> --name <cluster-name>

kubectl get nodes

kubectl describe node 


--------------IN CMD -- TO SEE THE CONFIG FILE

type %USERPROFILE%\.kube\config



-----------IN POWERSHELL

Get-Content $HOME\.kube\config



---Kubernetes Dashboard
kubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v2.7.0/aio/deploy/recommended.yaml


kubectl get namespaces




---Open vs code and open the code ofler of th sprejc and navaige tot he folder -- banking-classification-eks in the terminal 



cd banking-based-classification\banking-classification-eks


kubectl apply -f kubernetes-dashboard-admin.yaml


----Exception


kubectl proxy

kubectl get pods -n kubernetes-dashboard

kubectl get sa -n kubernetes-dashboard

kubectl -n kubernetes-dashboard create token admin-user


kubectl rollout restart deployment kubernetes-dashboard -n kubernetes-dashboard


kubectl proxy

http://127.0.0.1:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/




kubectl get pods -n kube-system -o wide

If the coredns is not ready, this is what you should do---



kubectl apply -f namespace.yaml


kubectl get namespaces


kubectl apply -f deployment.yaml

kubectl get deployments -n banking-classification

kubectl apply -f service.yaml

kubectl get svc -n banking-classification


http://<EC2_PUBLIC_IP>:<NODEPORT>


aws eks describe-cluster --name <cluster-name> --region <region-name> --query "cluster.identity.oidc.issuer" --output text


windows

aws iam list-open-id-connect-providers | findstr <oidc-id>


Linux

aws iam list-open-id-connect-providers | grep <oidc-id>

-------------------

aws iam list-open-id-connect-providers


curl -O https://raw.githubusercontent.com/kubernetes-sigs/aws-load-balancer-controller/v2.13.3/docs/install/iam_policy.json


aws iam create-policy --policy-name AWSLoadBalancerControllerIAMPolicy --policy-document file://iam_policy.json



{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Principal": {
        "Federated": "arn:aws:iam::<Account-id>:oidc-provider/oidc.eks.us-east-1.amazonaws.com/id/<OIDC-ID>"
      },
      "Action": "sts:AssumeRoleWithWebIdentity",
      "Condition": {
        "StringEquals": {
          "oidc.eks.us-east-1.amazonaws.com/id/<OIDC-ID>:sub": "system:serviceaccount:kube-system:aws-load-balancer-controller"
        }
      }
    }
  ]
}



kubectl get deployment -n kube-system alb-ingress-controller

----Run in CMD Administrator

choco install kubernetes-helm


helm version

helm repo add eks https://aws.github.io/eks-charts

helm repo update


helm upgrade --install aws-load-balancer-controller eks/aws-load-balancer-controller -n kube-system --set clusterName=<cluster-name> --set serviceAccount.create=false --set serviceAccount.name=aws-load-balancer-controller --set region=us-east-1 --set vpcId=<vpc-id>


kubectl get deployment aws-load-balancer-controller -n kube-system


kubectl apply -f ingress.yaml

kubectl describe ingress banking-based-classification-ingress -n banking-classification

kubectl get pods -n kube-system -l app.kubernetes.io/name=aws-load-balancer-controller


kubectl rollout restart deployment aws-load-balancer-controller -n kube-system


kubectl get pods -n banking-classification


kubectl get svc banking-based-classification-svc -n banking-classification


kubectl get configmap aws-auth -n kube-system -o yaml

kubectl rollout restart deployment/banking-based-classification-deployment -n banking-classification


curl -X POST http://<alb-dns>/bank-classification

kubectl get deployment banking-based-classification-deployment -n banking-classification -o yaml

kubectl get pods -n banking-classification -o jsonpath="{.items[*].spec.containers[*].image}"





